<!DOCTYPE html>
<html>
<head>
    <title>TCG Client</title>
    <style>
        body { font-family: sans-serif; padding: 20px; }
        .section { margin: 20px 0; padding: 15px; border: 1px solid #ccc; }
        .section-header { display: flex; justify-content: space-between; align-items: center; }
        .section-header h3 { margin: 0; }
        .hide-btn { background: #eee; border: 1px solid #ccc; padding: 2px 8px; cursor: pointer; font-size: 12px; }
        .section-content.hidden { display: none; }
        button { margin: 5px; padding: 8px 16px; }
        input { padding: 8px; font-size: 16px; }
        select { padding: 8px; font-size: 16px; }
        #game-controls { display: none; }
        #log { background: #f5f5f5; padding: 10px; max-height: 300px; overflow-y: auto; }
        .status { font-weight: bold; color: #666; }
        .health-display { display: flex; gap: 20px; margin-bottom: 15px; }
        .health-box { background: #e8f5e9; border: 2px solid #4caf50; padding: 10px 20px; border-radius: 8px; text-align: center; }
        .health-box span:first-child { display: block; font-size: 12px; color: #666; }
        .health-box span:last-child { display: block; font-size: 24px; font-weight: bold; }
        .health-box.opponent { background: #ffebee; border-color: #f44336; }
        .hand-area { margin: 15px 0; }
        .hand { display: flex; flex-wrap: wrap; gap: 10px; }
        .card {
            border: 2px solid #333;
            border-radius: 8px;
            padding: 10px;
            width: 120px;
            background: #fff;
            cursor: pointer;
            font-size: 12px;
        }
        .card:hover { border-color: #2196f3; background: #e3f2fd; }
        .card .card-name { font-weight: bold; margin-bottom: 5px; }
        .card .card-stats { color: #666; }
        .card .card-cost { color: #9c27b0; font-size: 11px; }
        .field-area { margin: 15px 0; padding: 10px; background: #f0f0f0; border-radius: 8px; }
        .field { display: flex; flex-wrap: wrap; gap: 10px; min-height: 50px; }
        .field-card {
            border: 2px solid #4caf50;
            border-radius: 8px;
            padding: 10px;
            width: 120px;
            background: #e8f5e9;
            font-size: 12px;
        }
        .field-card.can-attack { border-color: #ff9800; background: #fff3e0; cursor: pointer; }
        .field-card .card-name { font-weight: bold; margin-bottom: 5px; }
        .field-card .card-health { color: #d32f2f; }
        .field-card .card-attack { color: #1976d2; }
        .lands-area { margin: 15px 0; padding: 10px; background: #e8e8e8; border-radius: 8px; }
        .lands { display: flex; flex-wrap: wrap; gap: 8px; min-height: 40px; }
        .land-card {
            border: 2px solid #795548;
            border-radius: 6px;
            padding: 6px 10px;
            background: #efebe9;
            font-size: 11px;
        }
        .land-card .card-name { font-weight: bold; }
        .field-card.opponent { border-color: #f44336; background: #ffebee; }
        .land-card.opponent { border-color: #c62828; background: #ffcdd2; }
        .opponent-area { background: #fff5f5; border: 1px dashed #f44336; }
        .land-card.tapped { transform: rotate(90deg); opacity: 0.6; margin: 10px 15px; }
        .field-card.tapped { transform: rotate(90deg); opacity: 0.6; margin: 10px 15px; }
        .tapped-label { font-size: 9px; color: #999; }
        .land-card { cursor: pointer; transition: transform 0.2s; }
        .land-card:hover:not(.tapped) { border-color: #4caf50; background: #e8f5e9; }
        .mana-pool { color: #9c27b0; font-weight: bold; }
        .burn-btn {
            background: #ff5722;
            color: white;
            border: none;
            padding: 2px 6px;
            font-size: 10px;
            cursor: pointer;
            border-radius: 3px;
            margin-top: 4px;
        }
        .burn-btn:hover { background: #e64a19; }
        /* Combat styles */
        .field-card.selected-attacker { border-color: #2196f3; background: #e3f2fd; box-shadow: 0 0 10px #2196f3; }
        .field-card.attacking { border-color: #ff5722; background: #fff3e0; }
        .field-card.targetable { border-color: #e91e63; background: #fce4ec; }
        .field-card.targeted { border-color: #9c27b0; background: #f3e5f5; box-shadow: 0 0 10px #9c27b0; }
        .health-box.targetable { border-color: #e91e63; background: #fce4ec; cursor: crosshair; }
        .health-box.targeted { border-color: #9c27b0; background: #f3e5f5; box-shadow: 0 0 10px #9c27b0; }
        /* Abilities styling */
        .card-abilities { font-size: 10px; color: #673ab7; font-style: italic; margin-top: 3px; }
        /* Card text styling */
        .card-text { font-size: 10px; color: #555; margin: 4px 0; line-height: 1.3; }
        body.dark-mode .card-text { color: #aaa; }
        /* Tooltip for field cards */
        .field-card { position: relative; }
        .field-card .card-tooltip {
            display: none;
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: #333;
            color: #fff;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 11px;
            white-space: normal;
            width: 180px;
            z-index: 100;
            box-shadow: 0 2px 8px rgba(0,0,0,0.3);
            margin-bottom: 5px;
        }
        .field-card:hover .card-tooltip { display: block; }
        .field-card .card-tooltip::after {
            content: '';
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 6px solid transparent;
            border-top-color: #333;
        }
        body.dark-mode .field-card .card-tooltip { background: #1a1a1a; border: 1px solid #444; }
        /* Leader card styles */
        .leader-area { display: flex; gap: 20px; margin: 15px 0; }
        .leader-card {
            border: 3px solid #ffd700;
            border-radius: 10px;
            padding: 12px;
            width: 220px;
            background: linear-gradient(135deg, #fff9e6 0%, #fff3cc 100%);
            box-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
        }
        .leader-card .card-name { font-weight: bold; margin-bottom: 5px; color: #b8860b; }
        .leader-card .card-stats { color: #666; }
        .leader-card .card-text { font-size: 10px; color: #555; margin: 6px 0; line-height: 1.3; font-style: italic; }
        .leader-card .leader-label { font-size: 10px; color: #daa520; text-transform: uppercase; letter-spacing: 1px; }
        .leader-card.opponent { border-color: #ff6b6b; background: linear-gradient(135deg, #ffe6e6 0%, #ffcccc 100%); box-shadow: 0 0 10px rgba(255, 107, 107, 0.5); }
        .leader-card.opponent .card-name { color: #c0392b; }
        .leader-card.opponent .leader-label { color: #e74c3c; }
        body.dark-mode .leader-card { background: linear-gradient(135deg, #3d3520 0%, #4d4530 100%); border-color: #ffd700; }
        body.dark-mode .leader-card .card-name { color: #ffd700; }
        body.dark-mode .leader-card .card-stats { color: #ccc; }
        body.dark-mode .leader-card .card-text { color: #aaa; }
        body.dark-mode .leader-card.opponent { background: linear-gradient(135deg, #3d2525 0%, #4d3030 100%); border-color: #ff6b6b; }
        body.dark-mode .leader-card.opponent .card-name { color: #ff6b6b; }
        /* Blocking styles */
        .field-card.can-block { border-color: #00bcd4; background: #e0f7fa; }
        .field-card.selected-blocker { border-color: #00bcd4; background: #b2ebf2; box-shadow: 0 0 10px #00bcd4; }
        .field-card.blocking { border-color: #009688; background: #e0f2f1; }
        .field-card.blockable { border-color: #ff5722; background: #fff3e0; animation: pulse 1s infinite; }
        .field-card.being-blocked { border-color: #607d8b; background: #eceff1; opacity: 0.7; }
        @keyframes pulse { 0%, 100% { box-shadow: 0 0 5px #ff5722; } 50% { box-shadow: 0 0 15px #ff5722; } }
        /* Instant card buttons */
        .instant-btn {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            border: 2px solid #2196f3;
            border-radius: 6px;
            padding: 8px 12px;
            cursor: pointer;
            text-align: center;
            min-width: 100px;
            transition: all 0.2s;
        }
        .instant-btn:hover:not(.disabled) { background: linear-gradient(135deg, #bbdefb 0%, #90caf9 100%); transform: scale(1.05); }
        .instant-btn.selected { border-color: #ff9800; box-shadow: 0 0 10px #ff9800; background: linear-gradient(135deg, #fff3e0 0%, #ffe0b2 100%); }
        .instant-btn.disabled { opacity: 0.5; cursor: not-allowed; border-color: #999; }
        body.dark-mode .instant-btn { background: linear-gradient(135deg, #1e3a5f 0%, #2c5282 100%); border-color: #4299e1; color: #fff; }
        body.dark-mode .instant-btn.selected { background: linear-gradient(135deg, #553c00 0%, #744e00 100%); border-color: #ff9800; }
        body.dark-mode #response-controls { background: #3d3520; border-color: #ff9800; }
        body.dark-mode #response-controls h4 { color: #ff9800; }
        body.dark-mode #response-status { color: #ccc; }
        /* Lobby/Game list styles */
        .game-item {
            display: flex;
            flex-direction: column;
            padding: 10px;
            margin: 8px 0;
            border: 1px solid #ddd;
            border-radius: 6px;
            background: #fafafa;
        }
        .game-item:hover { background: #f0f0f0; }
        .game-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 5px;
        }
        .game-info strong { color: #333; }
        .game-status {
            font-size: 12px;
            padding: 2px 8px;
            border-radius: 10px;
            background: #e3f2fd;
            color: #1976d2;
        }
        .game-status.in-progress { background: #fff3e0; color: #e65100; }
        .game-players { font-size: 13px; color: #666; margin-bottom: 8px; }
        .game-item button {
            align-self: flex-start;
            background: #4caf50;
            color: white;
            border: none;
            padding: 6px 16px;
            border-radius: 4px;
            cursor: pointer;
        }
        .game-item button:hover { background: #388e3c; }
        #game-list-container { border-top: 1px solid #eee; padding-top: 10px; }
        /* Dark mode toggle */
        .top-bar { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .top-bar h1 { margin: 0; }
        .dark-toggle { background: #333; color: #fff; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; }
        .dark-toggle:hover { background: #555; }
        /* Dark mode styles */
        body.dark-mode { background: #1a1a1a; color: #e0e0e0; }
        body.dark-mode .section { border-color: #444; background: #252525; }
        body.dark-mode .card { background: #2d2d2d; border-color: #555; color: #e0e0e0; }
        body.dark-mode .card:hover { border-color: #2196f3; background: #353535; }
        body.dark-mode .card .card-stats { color: #aaa; }
        body.dark-mode .field-area { background: #2a2a2a; }
        body.dark-mode .field-card { background: #2d3d2d; border-color: #4caf50; color: #e0e0e0; }
        body.dark-mode .field-card.can-attack { background: #3d3525; border-color: #ff9800; }
        body.dark-mode .field-card.opponent { background: #3d2d2d; border-color: #f44336; }
        body.dark-mode .lands-area { background: #2a2a2a; }
        body.dark-mode .land-card { background: #3d3530; border-color: #795548; color: #e0e0e0; }
        body.dark-mode .land-card:hover:not(.tapped) { background: #2d3d2d; border-color: #4caf50; }
        body.dark-mode .land-card.opponent { background: #3d2525; border-color: #c62828; }
        body.dark-mode .health-box { background: #2d3d2d; color: #e0e0e0; }
        body.dark-mode .health-box.opponent { background: #3d2d2d; }
        body.dark-mode .opponent-area { background: #2d2525; border-color: #f44336; }
        body.dark-mode #log { background: #252525; color: #e0e0e0; }
        body.dark-mode .status { color: #aaa; }
        body.dark-mode .game-item { background: #2d2d2d; border-color: #444; }
        body.dark-mode .game-item:hover { background: #353535; }
        body.dark-mode .game-info strong { color: #e0e0e0; }
        body.dark-mode .game-players { color: #aaa; }
        body.dark-mode input, body.dark-mode select { background: #2d2d2d; color: #e0e0e0; border: 1px solid #555; }
        body.dark-mode .hide-btn { background: #444; border-color: #555; color: #e0e0e0; }
        #mulligan-controls { background: #fff3e0; }
        body.dark-mode #mulligan-controls { background: #3d3525; color: #e0e0e0; }
        #draw-phase-controls { background: #e3f2fd; }
        body.dark-mode #draw-phase-controls { background: #263238; color: #e0e0e0; }
        body.dark-mode .dark-toggle { background: #e0e0e0; color: #1a1a1a; }
        body.dark-mode .dark-toggle:hover { background: #fff; }
        body.dark-mode .top-bar a { color: #e0e0e0; border-color: #e0e0e0; }
        body.dark-mode .top-bar a:hover { background: #333; }
        body.dark-mode #game-list-container { border-color: #444; }
        /* Chat styling */
        #chat-messages { background: #f5f5f5; }
        body.dark-mode #chat-section { background: #252525; border-color: #444; }
        body.dark-mode #chat-messages { background: #1e1e1e; color: #e0e0e0; border: 1px solid #444; }
        body.dark-mode #chat-input { background: #2d2d2d; color: #e0e0e0; border-color: #555; }
    </style>
</head>
<body>
    <div class="top-bar">
        <h1>TCG Test Client</h1>
        <div style="display: flex; gap: 10px; align-items: center;">
            <a href="https://github.com/WilPermenter/CardGame" target="_blank" style="color: #333; text-decoration: none; padding: 8px 16px; border: 1px solid #333; border-radius: 4px; font-size: 14px;">GitHub</a>
            <button class="dark-toggle" onclick="toggleDarkMode()">Dark Mode</button>
        </div>
    </div>

    <div class="section" id="lobby">
        <div class="section-header">
            <h3>Lobby</h3>
            <button class="hide-btn" onclick="toggleSection(this)">hide</button>
        </div>
        <div class="section-content">
            <label>Your UID: <input type="text" id="uid" placeholder="Enter your name/id"></label>
            <br><br>
            <div id="deck-select-area">
                <label>Select Deck:
                    <select id="deck-select">
                        <option value="">Loading decks...</option>
                    </select>
                </label>
                <br><br>
            </div>
            <button onclick="startGame()" id="start-btn">Create Game</button>
            <button onclick="refreshGameList()" id="browse-btn">Browse Games</button>
            <button id="reconnect-btn" style="display:none; background:#ff9800; color:white;">Reconnect</button>
            <button onclick="leaveGame()" id="leave-btn" style="display:none;">Leave Game</button>
            <p class="status" id="status">Enter a UID and select a deck</p>

            <div id="game-list-container" style="margin-top:15px;">
                <h4>Available Games <button onclick="refreshGameList()" style="font-size:12px;">Refresh</button></h4>
                <div id="game-list"></div>
            </div>
        </div>
    </div>

    <div class="section" id="chat-section" style="display:none;">
        <div class="section-header">
            <h3>Chat</h3>
            <button class="hide-btn" onclick="toggleSection(this)">hide</button>
        </div>
        <div class="section-content">
            <div id="chat-messages" style="padding:10px; height:150px; overflow-y:auto; margin-bottom:10px; border-radius:4px;"></div>
            <div style="display:flex; gap:5px;">
                <input type="text" id="chat-input" placeholder="Type a message..." style="flex:1; padding:8px;" onkeypress="if(event.key==='Enter')sendChat()">
                <button onclick="sendChat()" style="background:#2196f3; color:white; border:none; padding:8px 16px; cursor:pointer;">Send</button>
            </div>
        </div>
    </div>

    <div class="section" id="game-controls">
        <div class="section-header">
            <h3>Game Controls</h3>
            <button class="hide-btn" onclick="toggleSection(this)">hide</button>
        </div>
        <div class="section-content">
            <div class="health-display">
                <div class="health-box">
                    <span>You</span>
                    <span id="my-health">30</span>
                </div>
                <div class="health-box opponent" id="opponent-health-box">
                    <span>Opponent</span>
                    <span id="opponent-health">30</span>
                </div>
            </div>
            <div class="field-area opponent-area">
                <h4>Opponent's Field (<span id="opponent-field-count">0</span>)</h4>
                <div id="opponent-field" class="field"></div>
            </div>
            <div class="lands-area opponent-area">
                <h4>Opponent's Lands (<span id="opponent-lands-count">0</span>)</h4>
                <div id="opponent-lands" class="lands"></div>
            </div>
            <hr style="margin: 20px 0; border: 1px solid #ccc;">
            <div class="field-area">
                <h4>Your Field (<span id="field-count">0</span>)</h4>
                <div id="field" class="field"></div>
            </div>
            <div class="lands-area">
                <h4>Your Lands (<span id="lands-count">0</span>) | Mana Pool: <span id="mana-display" class="mana-pool">0</span></h4>
                <div id="lands" class="lands"></div>
            </div>
            <div class="leader-area">
                <div>
                    <h4>Your Leader</h4>
                    <div id="my-leader" class="leader-card"></div>
                </div>
                <div>
                    <h4>Opponent's Leader</h4>
                    <div id="opponent-leader" class="leader-card opponent"></div>
                </div>
            </div>
            <div class="hand-area">
                <h4>Your Hand (<span id="hand-count">0</span>) | Deck: <span id="deck-count">0</span> | Vault: <span id="vault-count">0</span> | Discard: <span id="discard-count">0</span></h4>
                <div id="hand" class="hand"></div>
                <div id="mulligan-controls" style="display:none; margin-top:10px; padding:12px; border-radius:8px; text-align:center;">
                    <span style="margin-right:15px; font-weight:bold;">Mulligan Phase:</span>
                    <button onclick="keepHand()" style="background:#4caf50; color:white; border:none; padding:8px 16px; margin:0 5px; cursor:pointer; border-radius:4px;">Keep Hand</button>
                    <button onclick="takeMulligan()" style="background:#ff9800; color:white; border:none; padding:8px 16px; margin:0 5px; cursor:pointer; border-radius:4px;">Mulligan</button>
                </div>
                <div id="draw-phase-controls" style="display:none; margin-top:10px; padding:12px; border-radius:8px; text-align:center;">
                    <span style="margin-right:15px; font-weight:bold;">Draw Phase:</span>
                    <button id="draw-main-btn" onclick="drawFromMain()" style="background:#2196f3; color:white; border:none; padding:8px 16px; margin:0 5px; cursor:pointer; border-radius:4px;">Draw from Deck</button>
                    <button id="draw-vault-btn" onclick="drawFromVault()" style="background:#9c27b0; color:white; border:none; padding:8px 16px; margin:0 5px; cursor:pointer; border-radius:4px;">Draw from Vault</button>
                </div>
            </div>
            <div style="margin: 10px 0;">
                <button onclick="toggleCombatMode()" id="combat-btn">Combat</button>
                <button onclick="confirmAttacks()" id="confirm-attacks-btn" style="display:none; background:#4caf50; color:white;">Confirm Attacks</button>
                <button onclick="cancelCombat()" id="cancel-combat-btn" style="display:none; background:#f44336; color:white;">Cancel</button>
                <button onclick="confirmBlockers()" id="confirm-block-btn" style="display:none; background:#4caf50; color:white;">Confirm Blockers</button>
                <button onclick="skipBlocking()" id="skip-block-btn" style="display:none; background:#ff9800; color:white;">No Blockers</button>
                <button onclick="endTurn()">End Turn</button>
            </div>
            <p class="status" id="combat-status"></p>
            <p class="status" id="blocking-status" style="display:none; color:#e91e63;"></p>
            <!-- Response window controls -->
            <div id="response-controls" style="display:none; margin:15px 0; padding:15px; border:2px solid #ff9800; border-radius:8px; background:#fff8e1;">
                <h4 style="margin:0 0 10px 0; color:#e65100;">Combat Response</h4>
                <p id="response-status" style="margin:0 0 10px 0; color:#666;"></p>
                <div id="response-instants" style="display:flex; gap:10px; flex-wrap:wrap; margin-bottom:10px;"></div>
                <button id="pass-priority-btn" onclick="passPriority()" style="background:#9e9e9e; color:white; border:none; padding:8px 20px; border-radius:4px; cursor:pointer;">Pass</button>
            </div>
            <p class="status" id="turn-status"></p>
        </div>
    </div>

    <div class="section">
        <div class="section-header">
            <h3>Event Log</h3>
            <button class="hide-btn" onclick="toggleSection(this)">hide</button>
        </div>
        <div class="section-content">
            <pre id="log"></pre>
        </div>
    </div>

    <script src="client.js"></script>
</body>
</html>
